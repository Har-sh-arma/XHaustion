<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#317EFB" />
    <link rel="stylesheet" href="../../global.css">
    <link rel="stylesheet" href="style.css">
    <title>Config</title>
</head>
<body>
    <div class="nav">
        <div class="nav-font"><a href="../">BACK</a></div>
    </div>
        
    <div class="content" id="content">
        
    </div>
    
    <script src="../../global.js"></script>

    <script>

        let selectedHood = 0
        let animate =  async() => {
            let config = await getConfig()
            document.querySelector(".nav").innerHTML = `<div class="nav-font"><a href="../">BACK</a></div>`
            for (let i = 0; i < config["temperature_range"]; i++) {
                let buttonHTML = `<div class="nav-font"><a onclick="selectHood(${i})">Hood ${i+1}</a></div>`
                if(i == selectedHood){
                buttonHTML = `<div class="nav-font"><a class="current_nav" onclick="console.log("hello")">Hood ${i+1}</a></div>`
                }
                document.querySelector(".nav").innerHTML += buttonHTML
            }
            let content = document.querySelector(".content")
            content.innerHTML = ""
            for (let i = 0; i < config["num_dampers"]; i++) {
                content.innerHTML += `<div class="inp_cont">
                    <div class="currValue">${config["fan_power_scaling_for_hoods"][selectedHood][i]} %</div>
                    <input type="range" value="${config["fan_power_scaling_for_hoods"][selectedHood][i]}" min="0" max="100" step="${config["fan_step"]}"class="vertical"><div class="temperature">${config["temperature_range"][i]} Â°C</div></div>`
            }
            let inps = document.querySelectorAll("input")
            for (let i = 0; i < inps.length; i++) {
                inps[i].addEventListener("change", function (value) {
                    config["fan_power_scaling_for_hoods"][selectedHood][i] = Number(value.target.value)
                    setConfig(config)
                    setTimeout(animate, 0)
                })
            }
        }




        const selectHood = (i) => {
            selectedHood = i
            animate()
        }

        animate()

        

    </script>
</body>
</html>

